 {% include 'header_jstree.twig' %}

<body class="browser">

    <div dir="{{lang.applangdir}}">

        <div class="logo">
            <a href="{{subfolder}}/" target="_parent">{{appName}}</a>
        </div>
        <div class="refreshTree">
            <a href="{{subfolder}}/src/views/jstree" target="browser">
                    <img src="{{icon.Refresh}}" alt="{{lang.strrefresh}}" title="{{lang.strrefresh}}" />
                </a>
        </div>


        <div id="lazy" class="demo"></div>

    </div>

    <script>
        $('#lazy').jstree({
            "state": {
                "key": "jstree"
            },
            "plugins": ["state"],
            'core': {
               'data': {
                    "url": function (node) {
                        if (node.id === '#') {
                            return '{{subfolder}}/src/views/browser?action=tree&json=true';
                        } else {
                            return node.original.url + '&json=true';
                        }
                    }/*,
                    "data": function (node) {
                        if (node.id === '#') {
                            return;
                        }
                        return node.original;
                    }*/
                }
            }
        });

        $('#lazy').on("activate_node.jstree", function (e, data) {
            //console.log('activate_node',data);
            if(window.parent.frames.detail) {
                window.parent.frames.detail.location.replace(data.node.a_attr.href);
            }
        });
        $('#lazy').on("loaded.jstree", function (e, data) {
            $('#lazy').data('jstree').show_dots(); 
        });

        
    </script>

</body>

</html>